# Python util to get info of  malicious IP/URLs, for network security purposes

## Install enviroment and requeriments
```shell
conda create -n mwh python==3.9.* -y  ; conda activate mwh ; pip install -r requeriments.txt
```


## Setup `config.json` for VirusTotal (API V3) module
Create a json file to store your API key

```json
{
    "api_key": "YourAPIkey"
}
```
Then you can call the module `virus_total_util.VirusTotalAnalyzer` like this
```python
from modules.virus_total_util import VirusTotalAnalyzer
VTA = VirusTotalAnalyzer(config_json='config.json')

scan : dict = VTA.scan_ip('51.15.70.79')
if VTA.is_malicious_ip(scan):
    """
    Code to execute when the ip is malicious
    """
```

## MalwareBytes module
If you have the most recent version of Windows MalwareBytes Premium you can also use my own python module `mb_util.MalwarebytesLogManager` to retrieve the malicious inbound IPs. 
```python
from modules.mb_util import MalwarebytesLogManager

MBM = MalwarebytesLogManager(only_inbound=True)

for ip in MBM.get_inbound_ip_detections():
    """
    then scan the ip for details
    """
```
## Content `main.py` 
This is an example of IP info retrieval form VT API using MalwareBytes inbound detections and avoiding new  API requests of  IPs previously analysed and saved at detections.csv.
https://github.com/Eric106/malwareHouses/blob/f96c47c53e051d5787f128fe3a274aa9baabdf4a/main.py#L1-L47


##  Output of `main.py` at `detections.csv`
https://github.com/Eric106/malwareHouses/blob/f96c47c53e051d5787f128fe3a274aa9baabdf4a/detections.csv#L1-L22