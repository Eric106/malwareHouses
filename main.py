from modules.virus_total_util import VirusTotalAnalyzer
from modules.mb_util import MalwarebytesLogManager
from ipaddress import IPv4Network

VTA = VirusTotalAnalyzer('config.json')

MBM = MalwarebytesLogManager()

for ip in MBM.get_inbound_ip_detections():
    scan = VTA.scan_ip(ip)
    if VTA.is_malicious_ip(scan):
        subnet = VTA.get_ip_subnet(scan)
        ip_range = IPv4Network(subnet)
        print(ip,"-> subnet ->", ip_range, "-> ip range ->", ip_range[0], ip_range[-1])